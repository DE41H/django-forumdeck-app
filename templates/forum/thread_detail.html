{% extends 'base.html' %}
{% block content %}
<div class="bg-white border border-slate-200 rounded-xl p-8 mb-8">
    <div class="flex justify-between items-start mb-6">
        <h1 class="text-3xl font-extrabold text-slate-900">{{ thread.title }}</h1>
        <a href="{% url 'threads:report' thread.pk 'thread' %}" class="text-slate-400 hover:text-red-500" title="Report">
            <i data-lucide="flag" class="w-5 h-5"></i>
        </a>
    </div>
    
    <div class="prose max-w-none text-slate-700 mb-8">
        {{ thread.raw_content|linebreaks }}
    </div>

    <div class="flex items-center justify-between border-t pt-6 text-sm">
        <div class="flex items-center gap-4 text-slate-500">
            <span class="font-medium text-slate-900">Posted by {{ thread.author.username }}</span>
            <span>{{ thread.created_at|date:"M d, Y" }}</span>
        </div>
        <form action="{% url 'threads:upvote' thread.pk 'thread' %}" method="post" class="flex items-center gap-2">
            {% csrf_token %}
            <button class="flex items-center gap-1 px-3 py-1 bg-slate-100 rounded-full hover:bg-indigo-100 hover:text-indigo-600 transition-all">
                <i data-lucide="thumbs-up" class="w-4 h-4"></i> {{ thread.upvote_count }}
            </button>
        </form>
    </div>
</div>

<section class="space-y-6">
    <h2 class="text-xl font-bold flex items-center gap-2">
        <i data-lucide="messages-square"></i> Replies ({{ thread.reply_count }})
    </h2>

    <div class="bg-white border border-slate-200 rounded-xl p-6 shadow-sm">
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="mt-4 bg-indigo-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-indigo-700">Post Reply</button>
        </form>
    </div>

    <div class="space-y-4">
        {% for reply in thread.replies.all %}
        <div class="bg-white border border-slate-100 rounded-xl p-6 shadow-sm flex gap-4">
            <div class="flex flex-col items-center min-w-[40px]">
                <form action="{% url 'threads:upvote' reply.pk 'reply' %}" method="post">
                    {% csrf_token %}
                    <button class="text-slate-300 hover:text-indigo-600"><i data-lucide="arrow-big-up" class="w-6 h-6"></i></button>
                </form>
                <span class="text-xs font-bold">{{ reply.upvote_count }}</span>
            </div>
            <div class="flex-1">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-bold text-slate-800">{{ reply.author.username }}</span>
                    <span class="text-xs text-slate-400">{{ reply.created_at|timesince }} ago</span>
                </div>
                <p class="text-slate-700">{{ reply.raw_content|linebreaks }}</p>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}
