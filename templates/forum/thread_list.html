{% extends 'base.html' %}
{% block content %}
<nav class="flex mb-4 text-sm text-slate-500">
    <a href="{% url 'threads:category_list' %}" class="hover:text-indigo-600">Categories</a>
    <span class="mx-2">/</span>
    <span class="font-medium text-slate-900">{{ category.name }}</span>
</nav>

<div class="flex justify-between items-end mb-8">
    <div>
        <h1 class="text-3xl font-bold">{{ category.name }}</h1>
        <div class="flex gap-4 mt-2">
            <a href="?order_by=-created_at" class="text-sm {% if ordering == '-created_at' %}text-indigo-600 font-bold{% endif %}">Latest</a>
            <a href="?order_by=upvote_count" class="text-sm {% if ordering == 'upvote_count' %}text-indigo-600 font-bold{% endif %}">Popular</a>
        </div>
    </div>
    <button onclick="document.getElementById('threadForm').classList.toggle('hidden')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-700 flex items-center gap-2">
        <i data-lucide="plus-circle" class="w-4 h-4"></i> New Thread
    </button>
</div>

<div id="threadForm" class="hidden mb-8 p-6 bg-white border border-slate-200 rounded-xl shadow-inner">
    <form method="post">
        {% csrf_token %}
        <div class="space-y-4">
            {{ form.as_p }}
            <button type="submit" class="w-full bg-slate-900 text-white py-2 rounded-lg font-medium hover:bg-slate-800">Post Thread</button>
        </div>
    </form>
</div>

<div class="bg-white border border-slate-200 rounded-xl overflow-hidden divide-y divide-slate-100">
    {% for thread in threads %}
    <div class="p-5 hover:bg-slate-50 transition-colors flex items-start gap-4">
        <div class="flex flex-col items-center gap-1 min-w-[48px]">
            <form action="{% url 'threads:upvote' thread.pk 'thread' %}" method="post">
                {% csrf_token %}
                <button class="text-slate-400 hover:text-indigo-600 transition-colors">
                    <i data-lucide="chevron-up" class="w-8 h-8"></i>
                </button>
            </form>
            <span class="text-sm font-bold">{{ thread.upvote_count }}</span>
        </div>
        <div class="flex-1">
            <h3 class="text-lg font-semibold mb-1">
                <a href="{% url 'threads:thread_detail' thread.pk '-created_at' %}" class="hover:text-indigo-600">{{ thread.title }}</a>
            </h3>
            <div class="flex items-center gap-3 text-sm text-slate-500">
                <span class="flex items-center gap-1"><i data-lucide="user" class="w-3 h-3"></i> {{ thread.author.username }}</span>
                <span>•</span>
                <span>{{ thread.created_at|timesince }} ago</span>
                <span>•</span>
                <span class="flex items-center gap-1"><i data-lucide="message-circle" class="w-3 h-3"></i> {{ thread.reply_count }}</span>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="p-12 text-center text-slate-400">No threads yet. Be the first to start one!</div>
    {% endfor %}
</div>
{% endblock %}
